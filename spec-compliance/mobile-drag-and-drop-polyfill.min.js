/*! drag-drop-webkit-mobile 2.0.0 | Copyright (c) 2015 Tim Ruffles | BSD 2 License */
var MobileDragAndDropPolyfill;!function(a){function b(a){var b=c();b.userAgentNotSupportingNativeDnD===!1&&b.draggable&&b.dragEvents||(a&&Object.keys(a).forEach(function(a){w[a]=w[a]}),window.document.addEventListener("touchstart",d))}function c(){var a={draggable:"draggable"in window.document.documentElement,dragEvents:"ondragstart"in window.document.documentElement,touchEvents:"ontouchstart"in window.document.documentElement,isBlinkEngine:!!window.chrome||/chrome/i.test(navigator.userAgent),userAgentNotSupportingNativeDnD:!1};return a.userAgentNotSupportingNativeDnD=/iPad|iPhone|iPod|Android/.test(navigator.userAgent)||a.touchEvents&&a.isBlinkEngine,a}function d(a){if(!v){var b=e(a);if(b){a.preventDefault();try{v=new C(w,b,a,f)}catch(c){throw f(a,3),c}}}}function e(a){var b=a.target;do if(b.draggable!==!1&&b.getAttribute&&"true"===b.getAttribute("draggable"))return b;while((b=b.parentNode)&&b!==window.document.body)}function f(a,b){if(v=null,0===b){var c,d=a.target,e=d.tagName;switch(e){case"SELECT":c="mousedown";break;case"INPUT":case"TEXTAREA":d.focus();default:c="click"}var f=j(d,a,c);d.dispatchEvent(f)}}function g(a){return 0===a.length?0:a.reduce(function(a,b){return b+a},0)/a.length}function h(a){return a&&a.tagName}function i(a,b){for(var c=0;c<a.changedTouches.length;c++){var d=a.changedTouches[c];if(d.identifier===b)return!0}return!1}function j(a,b,c,d,e,f){void 0===d&&(d=!0),void 0===e&&(e=document.defaultView),void 0===f&&(f=null);var g=document.createEvent("MouseEvents"),h=b.changedTouches[0];g.initMouseEvent(c,!0,d,e,1,h.screenX,h.screenY,h.clientX,h.clientY,b.ctrlKey,b.altKey,b.shiftKey,b.metaKey,0,f);var i=a.getBoundingClientRect();return g.offsetX=g.clientX-i.left,g.offsetY=g.clientY-i.top,g}function k(a,b,c,d,e,f,g){void 0===g&&(g=null);var h=b.changedTouches[0],i=document.createEvent("Event");i.initEvent(c,!0,d),i.dataTransfer=f,i.relatedTarget=g,i.screenX=h.screenX,i.screenY=h.screenY,i.clientX=h.clientX,i.clientY=h.clientY;var j=a.getBoundingClientRect();return i.offsetX=i.clientX-j.left,i.offsetY=i.clientY-j.top,i}function l(a,b,c){for(var d=[],e=[],f=0;f<b.touches.length;f++){var h=b.touches[f];d.push(h[a+"X"]),e.push(h[a+"Y"])}c.x=g(d),c.y=g(e)}function m(a,b){return 1===arguments.length?a.documentElement.scrollLeft||a.body.scrollLeft:(a.documentElement.scrollLeft+=b,void(a.body.scrollLeft+=b))}function n(a,b){return 1===arguments.length?a.documentElement.scrollTop||a.body.scrollTop:(a.documentElement.scrollTop+=b,void(a.body.scrollTop+=b))}function o(a){var b=m(document);if(a.x>0){var c=document.documentElement.scrollWidth||document.body.scrollWidth;return b+document.documentElement.clientWidth>=c}return a.x<0?0>=b:!0}function p(a){var b=n(document);if(a.y>0){var c=document.documentElement.scrollHeight||document.body.scrollHeight;return b+document.documentElement.clientHeight>=c}return a.y<0?0>=b:!0}function q(a,b){if(1===a.nodeType){b.removeAttribute("id"),b.removeAttribute("class"),b.removeAttribute("style"),b.removeAttribute("draggable");for(var c=window.getComputedStyle(a),d=0;d<c.length;d++){var e=c[d];b.style.setProperty(e,c.getPropertyValue(e),c.getPropertyPriority(e))}b.style["pointer-events"]="none"}if(a.hasChildNodes())for(var d=0;d<a.childNodes.length;d++)q(a.childNodes[d],b.childNodes[d])}function r(a,b){return"none"===a?"none":0===a.indexOf("copy")||"all"===a?"copy":0===a.indexOf("link")?"link":"move"===a?"move":"uninitialized"===a&&3===b.nodeType&&"A"===b.tagName?"link":"copy"}function s(a,b,c,d,e,f,g){void 0===f&&(f=!0),void 0===g&&(g=null);var h=k(b,c,a,f,window.document.defaultView,e,g),i=!b.dispatchEvent(h);return d.mode=0,i}function t(a){if("uninitialized"===a.effectAllowed||"all"===a.effectAllowed)return a.dropEffect;if("copy"===a.dropEffect){if(0===a.effectAllowed.indexOf("copy"))return"copy"}else if("link"===a.dropEffect){if(0===a.effectAllowed.indexOf("link")||a.effectAllowed.indexOf("Link")>-1)return"link"}else if("move"===a.dropEffect&&(0===a.effectAllowed.indexOf("move")||a.effectAllowed.indexOf("Move")>-1))return"move";return"none"}function u(a,b,c,d){void 0===d&&(d=!0),d&&(b-=parseInt(a.offsetWidth,10)/2,c-=parseInt(a.offsetHeight,10)/2);for(var e="translate3d("+b+"px,"+c+"px, 0)",f=0;f<x.length;f++){var g=x[f]+"transform";a.style[g]=e}}var v;a.Initialize=function(a){b(a)};var w={dragImageClass:null,iterationInterval:150,scrollThreshold:50,scrollVelocity:10,debug:!1},x=["","-webkit-"],y="dnd-poly-",z=y+"drag-image",A=y+"snapback",B=y+"icon",C=function(){function a(a,b,c,d){this.config=a,this.sourceNode=b,this.dragOperationEndedCb=d,this.immediateUserSelection=null,this.currentDropTarget=null,this.dragOperationState=0,this.touchMoveHandler=this.onTouchMove.bind(this),this.touchEndOrCancelHandler=this.onTouchEndOrCancel.bind(this),this.lastTouchEvent=c,this.initialDragTouchIdentifier=this.lastTouchEvent.changedTouches[0].identifier,document.addEventListener("touchmove",this.touchMoveHandler),document.addEventListener("touchend",this.touchEndOrCancelHandler),document.addEventListener("touchcancel",this.touchEndOrCancelHandler)}return a.prototype.setupDragAndDropOperation=function(){var a=this;return this.dragOperationState=1,this.currentDragOperation="none",this.dragDataStore=new E,this.dataTransfer=new D(this.dragDataStore),this.currentHotspotCoordinates={x:null,y:null},this.createDragImage(this.lastTouchEvent),this.dragDataStore.mode=2,this.dataTransfer.dropEffect="none",s("dragstart",this.sourceNode,this.lastTouchEvent,this.dragDataStore,this.dataTransfer)?(this.dragOperationState=3,void this.cleanup()):(this.snapbackEndedCb=this.snapbackTransitionEnded.bind(this),void(this.iterationIntervalId=setInterval(function(){a.iterationLock||(a.iterationLock=!0,a.dragAndDropProcessModelIteration(),a.iterationLock=!1)},this.config.iterationInterval)))},a.prototype.cleanup=function(){this.iterationIntervalId&&(clearInterval(this.iterationIntervalId),this.iterationIntervalId=null),document.removeEventListener("touchmove",this.touchMoveHandler),document.removeEventListener("touchend",this.touchEndOrCancelHandler),document.removeEventListener("touchcancel",this.touchEndOrCancelHandler),this.dragImage&&(this.dragImage.parentNode.removeChild(this.dragImage),this.dragImage=null),this.dragOperationEndedCb(this.lastTouchEvent,this.dragOperationState)},a.prototype.onTouchMove=function(a){if(i(a,this.initialDragTouchIdentifier)!==!1){if(0===this.dragOperationState)return void this.setupDragAndDropOperation();if(a.preventDefault(),a.stopImmediatePropagation(),this.lastTouchEvent=a,l("client",a,this.currentHotspotCoordinates),l("page",a,this.dragImagePageCoordinates),this.determineScrollIntention(this.currentHotspotCoordinates.x,this.currentHotspotCoordinates.y),o(this.scrollIntention)===!1||p(this.scrollIntention)===!1)return void this.setupScrollAnimation();this.teardownScrollAnimation(),u(this.dragImage,this.dragImagePageCoordinates.x,this.dragImagePageCoordinates.y)}},a.prototype.onTouchEndOrCancel=function(a){if(i(a,this.initialDragTouchIdentifier)!==!1){if(this.teardownScrollAnimation(),0===this.dragOperationState)return void this.cleanup();a.preventDefault(),a.stopImmediatePropagation(),this.lastTouchEvent=a,this.dragOperationState="touchcancel"===a.type?3:2}},a.prototype.determineScrollIntention=function(a,b){this.scrollIntention||(this.scrollIntention={}),this.scrollIntention.x=a<this.config.scrollThreshold?-1:window.document.documentElement.clientWidth-a<this.config.scrollThreshold?1:0,this.scrollIntention.y=b<this.config.scrollThreshold?-1:window.document.documentElement.clientHeight-b<this.config.scrollThreshold?1:0},a.prototype.setupScrollAnimation=function(){this.scrollAnimationFrameId||(this.scrollAnimationCb=this.performScroll.bind(this),this.scrollAnimationFrameId=window.requestAnimationFrame(this.scrollAnimationCb))},a.prototype.teardownScrollAnimation=function(){this.scrollAnimationFrameId&&(window.cancelAnimationFrame(this.scrollAnimationFrameId),this.scrollAnimationFrameId=null,this.scrollAnimationCb=null)},a.prototype.performScroll=function(){if(this.scrollAnimationCb&&this.scrollAnimationFrameId){var a=o(this.scrollIntention),b=p(this.scrollIntention);if(a&&b)return void this.teardownScrollAnimation();if(!a){var c=this.scrollIntention.x*this.config.scrollVelocity;m(window.document,c),this.dragImagePageCoordinates.x+=c}if(!b){var d=this.scrollIntention.y*this.config.scrollVelocity;n(window.document,d),this.dragImagePageCoordinates.y+=d}u(this.dragImage,this.dragImagePageCoordinates.x,this.dragImagePageCoordinates.y),this.scrollAnimationFrameId=window.requestAnimationFrame(this.scrollAnimationCb)}},a.prototype.snapbackDragImage=function(){var a=this.sourceNode,b=window.getComputedStyle(a,null).getPropertyValue("visibility"),c=window.getComputedStyle(a,null).getPropertyValue("display");if("hidden"===b||"none"===c)return void this.snapbackTransitionEnded();this.dragImage.addEventListener("transitionend",this.snapbackEndedCb),this.dragImage.addEventListener("webkitTransitionEnd",this.snapbackEndedCb),this.dragImage.classList.add(A);var d,e,f=a.getBoundingClientRect(),g=document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop,h=document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft;e=f.top+g,d=f.left+h;var i=window.getComputedStyle(this.sourceNode,null),j=parseInt(i.getPropertyValue("padding-left"),10),k=parseInt(i.getPropertyValue("padding-top"),10);d-=j,e-=k,u(this.dragImage,d,e,!1)},a.prototype.snapbackTransitionEnded=function(){this.dragImage.removeEventListener("transitionend",this.snapbackEndedCb),this.dragImage.removeEventListener("webkitTransitionEnd",this.snapbackEndedCb),this.dragDataStore.mode=3,this.dataTransfer.dropEffect=this.currentDragOperation,s("dragend",this.sourceNode,this.lastTouchEvent,this.dragDataStore,this.dataTransfer,!1),this.dragOperationState=2,this.cleanup()},a.prototype.dragAndDropProcessModelIteration=function(){this.dragDataStore.mode=3,this.dataTransfer.dropEffect="none";var a=s("drag",this.sourceNode,this.lastTouchEvent,this.dragDataStore,this.dataTransfer);if(a&&(this.currentDragOperation="none"),a||2===this.dragOperationState||3===this.dragOperationState){var b=this.DragOperationEnded(this.dragOperationState);return b?void this.snapbackDragImage():(this.dragDataStore.mode=3,this.dataTransfer.dropEffect=this.currentDragOperation,s("dragend",this.sourceNode,this.lastTouchEvent,this.dragDataStore,this.dataTransfer,!1),this.dragOperationState=2,void this.cleanup())}var c=window.document.elementFromPoint(this.currentHotspotCoordinates.x,this.currentHotspotCoordinates.y),d=this.currentDropTarget;c!==this.immediateUserSelection&&c!==this.currentDropTarget&&(this.immediateUserSelection=c,null!==this.currentDropTarget&&(this.dragDataStore.mode=3,this.dataTransfer.dropEffect="none",s("dragexit",this.currentDropTarget,this.lastTouchEvent,this.dragDataStore,this.dataTransfer,!1)),null===this.immediateUserSelection?this.currentDropTarget=this.immediateUserSelection:(this.dragDataStore.mode=3,this.dataTransfer.dropEffect=r(this.dragDataStore.effectAllowed,this.sourceNode),s("dragenter",this.immediateUserSelection,this.lastTouchEvent,this.dragDataStore,this.dataTransfer)?(this.currentDropTarget=this.immediateUserSelection,this.currentDragOperation=t(this.dataTransfer)):this.immediateUserSelection===window.document.body||(this.currentDropTarget=window.document.body))),d!==this.currentDropTarget&&h(d)&&(this.dragDataStore.mode=3,this.dataTransfer.dropEffect="none",s("dragleave",d,this.lastTouchEvent,this.dragDataStore,this.dataTransfer,!1,this.currentDropTarget)),h(this.currentDropTarget)&&(this.dragDataStore.mode=3,this.dataTransfer.dropEffect=r(this.dragDataStore.effectAllowed,this.sourceNode),this.currentDragOperation=s("dragover",this.currentDropTarget,this.lastTouchEvent,this.dragDataStore,this.dataTransfer)===!1?"none":t(this.dataTransfer));for(var e=0;e<D.DropEffects.length;e++)this.dragImage.classList.remove(y+D.DropEffects[e]);this.dragImage.classList.add(y+this.currentDragOperation)},a.prototype.createDragImage=function(a){this.dragImage=this.sourceNode.cloneNode(!0),q(this.sourceNode,this.dragImage),this.dragImage.style.position="absolute",this.dragImage.style.left="0px",this.dragImage.style.top="0px",this.dragImage.style["z-index"]="999999",this.dragImage.classList.add(z),this.dragImage.classList.add(B),this.config.dragImageClass&&this.dragImage.classList.add(this.config.dragImageClass),this.dragImagePageCoordinates={x:null,y:null},l("page",a,this.dragImagePageCoordinates),u(this.dragImage,this.dragImagePageCoordinates.x,this.dragImagePageCoordinates.y),window.document.body.appendChild(this.dragImage)},a.prototype.DragOperationEnded=function(a){var b="none"===this.currentDragOperation||null===this.currentDropTarget||3===a;return b?h(this.currentDropTarget)&&(this.dragDataStore.mode=3,this.dataTransfer.dropEffect="none",s("dragleave",this.currentDropTarget,this.lastTouchEvent,this.dragDataStore,this.dataTransfer,!1)):h(this.currentDropTarget)&&(this.dragDataStore.mode=1,this.dataTransfer.dropEffect=this.currentDragOperation,this.currentDragOperation=s("drop",this.currentDropTarget,this.lastTouchEvent,this.dragDataStore,this.dataTransfer)===!0?this.dataTransfer.dropEffect:"none"),b},a}(),D=function(){function a(a){this.dataStore=a,this._dropEffect="none"}return Object.defineProperty(a.prototype,"files",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"items",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"types",{get:function(){return 0===this.dataStore.mode?null:Object.freeze(this.dataStore.types)},enumerable:!0,configurable:!0}),a.prototype.setData=function(a,b){if(2===this.dataStore.mode){if(a.indexOf(" ")>-1)throw new Error("Space character not allowed in drag data item type string");this.dataStore.data[a]=b,-1===this.dataStore.types.indexOf(a)&&this.dataStore.types.push(a)}},a.prototype.getData=function(a){return 0===this.dataStore.mode||3===this.dataStore.mode?null:this.dataStore.data[a]||""},a.prototype.clearData=function(a){if(2===this.dataStore.mode){if(a&&this.dataStore.data[a]){delete this.dataStore.data[a];var b=this.dataStore.types.indexOf(a);return void(b>-1&&this.dataStore.types.splice(b,1))}this.dataStore.data={},this.dataStore.types=[]}},a.prototype.setDragImage=function(a,b,c){0===this.dataStore.mode},Object.defineProperty(a.prototype,"effectAllowed",{get:function(){return this.dataStore.effectAllowed},set:function(b){0!==this.dataStore.mode&&-1!==a.AllowedEffects.indexOf(b)&&(this.dataStore.effectAllowed=b)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"dropEffect",{get:function(){return this._dropEffect},set:function(b){0!==this.dataStore.mode&&-1!==a.DropEffects.indexOf(b)&&(this._dropEffect=b)},enumerable:!0,configurable:!0}),a.AllowedEffects=["none","copy","copyLink","copyMove","link","linkMove","move","all"],a.DropEffects=["none","copy","move","link"],a}(),E=function(){function a(){this.mode=3,this.data={},this.types=[],this.effectAllowed="uninitialized"}return a}()}(MobileDragAndDropPolyfill||(MobileDragAndDropPolyfill={}));
//# sourceMappingURL=mobile-drag-and-drop-polyfill.min.map