/*! drag-drop-webkit-mobile 2.0.0 | Copyright (c) 2015 Tim Ruffles | BSD 2 License */
var MobileDragAndDropPolyfill;!function(a){a.Initialize=function(a){b.Initialize(a)};var b=function(){function a(){}return a.Initialize=function(b){var c=a.DetectFeatures();c.userAgentNotSupportingNativeDnD===!1&&c.draggable&&c.dragEvents||(b&&Object.keys(b).forEach(function(c){a.config[c]=b[c]}),window.document.addEventListener("touchstart",a.OnTouchstart))},a.DetectFeatures=function(){var a={draggable:"draggable"in window.document.documentElement,dragEvents:"ondragstart"in window.document.documentElement,touchEvents:"ontouchstart"in window.document.documentElement,isBlinkEngine:!!window.chrome||/chrome/i.test(navigator.userAgent),userAgentNotSupportingNativeDnD:!1};return a.userAgentNotSupportingNativeDnD=/iPad|iPhone|iPod|Android/.test(navigator.userAgent)||a.touchEvents&&a.isBlinkEngine,a},a.OnTouchstart=function(b){if(!a.activeDragOperation){var d=a.TryFindDraggableTarget(b);if(d){b.preventDefault();try{a.activeDragOperation=new c(a.config,d,b,a.DragOperationEnded)}catch(e){throw a.DragOperationEnded(b,3),e}}}},a.TryFindDraggableTarget=function(a){var b=a.target;do if(b.draggable!==!1&&b.getAttribute&&"true"===b.getAttribute("draggable"))return b;while((b=b.parentNode)&&b!==window.document.body)},a.DragOperationEnded=function(b,c){if(a.activeDragOperation=null,0===c){var d,e=b.target,g=e.tagName;switch(g){case"SELECT":d="mousedown";break;case"INPUT":case"TEXTAREA":e.focus();default:d="click"}var h=f.CreateMouseEventFromTouch(e,b,d);e.dispatchEvent(h)}},a.config={dragImageClass:null,iterationInterval:150,scrollThreshold:50,scrollVelocity:10,debug:!1},a}(),c=function(){function a(a,b,c,d){this.config=a,this.sourceNode=b,this.dragOperationEndedCb=d,this.immediateUserSelection=null,this.currentDropTarget=null,this.dragOperationState=0,this.touchMoveHandler=this.onTouchMove.bind(this),this.touchEndOrCancelHandler=this.onTouchEndOrCancel.bind(this),this.lastTouchEvent=c,this.initialDragTouchIdentifier=this.lastTouchEvent.changedTouches[0].identifier,document.addEventListener("touchmove",this.touchMoveHandler),document.addEventListener("touchend",this.touchEndOrCancelHandler),document.addEventListener("touchcancel",this.touchEndOrCancelHandler)}return a.prototype.setupDragAndDropOperation=function(){var a=this;return this.dragOperationState=1,this.currentDragOperation="none",this.dragDataStore=new e,this.dataTransfer=new d(this.dragDataStore),this.currentHotspotCoordinates={x:null,y:null},this.createDragImage(this.lastTouchEvent),this.dragDataStore.mode=2,this.dataTransfer.dropEffect="none",this.dispatchDragEvent("dragstart",this.sourceNode,this.lastTouchEvent,this.dragDataStore,this.dataTransfer)?(this.dragOperationState=3,void this.cleanup()):(this.snapbackEndedCb=this.snapbackTransitionEnded.bind(this),void(this.iterationIntervalId=setInterval(function(){a.iterationLock||(a.iterationLock=!0,a.dragAndDropProcessModelIteration(),a.iterationLock=!1)},this.config.iterationInterval)))},a.prototype.cleanup=function(){this.iterationIntervalId&&(clearInterval(this.iterationIntervalId),this.iterationIntervalId=null),document.removeEventListener("touchmove",this.touchMoveHandler),document.removeEventListener("touchend",this.touchEndOrCancelHandler),document.removeEventListener("touchcancel",this.touchEndOrCancelHandler),this.dragImage&&(this.dragImage.parentNode.removeChild(this.dragImage),this.dragImage=null),this.dragOperationEndedCb(this.lastTouchEvent,this.dragOperationState)},a.prototype.onTouchMove=function(b){if(f.IsTouchIdentifierContainedInTouchEvent(b,this.initialDragTouchIdentifier)!==!1){if(0===this.dragOperationState)return void this.setupDragAndDropOperation();if(b.preventDefault(),b.stopImmediatePropagation(),this.lastTouchEvent=b,f.UpdateCentroidCoordinatesOfTouchesIn("client",b,this.currentHotspotCoordinates),f.UpdateCentroidCoordinatesOfTouchesIn("page",b,this.dragImagePageCoordinates),this.determineScrollIntention(this.currentHotspotCoordinates.x,this.currentHotspotCoordinates.y),a.HorizontalScrollEndReach(this.scrollIntention)===!1||a.VerticalScrollEndReach(this.scrollIntention)===!1)return void this.setupScrollAnimation();this.teardownScrollAnimation(),this.translateDragImage(this.dragImagePageCoordinates.x,this.dragImagePageCoordinates.y)}},a.prototype.onTouchEndOrCancel=function(a){if(f.IsTouchIdentifierContainedInTouchEvent(a,this.initialDragTouchIdentifier)!==!1){if(this.teardownScrollAnimation(),0===this.dragOperationState)return void this.cleanup();a.preventDefault(),a.stopImmediatePropagation(),this.lastTouchEvent=a,this.dragOperationState="touchcancel"===a.type?3:2}},a.prototype.determineScrollIntention=function(a,b){this.scrollIntention||(this.scrollIntention={}),a<this.config.scrollThreshold?this.scrollIntention.x=-1:window.document.documentElement.clientWidth-a<this.config.scrollThreshold?this.scrollIntention.x=1:this.scrollIntention.x=0,b<this.config.scrollThreshold?this.scrollIntention.y=-1:window.document.documentElement.clientHeight-b<this.config.scrollThreshold?this.scrollIntention.y=1:this.scrollIntention.y=0},a.prototype.setupScrollAnimation=function(){this.scrollAnimationFrameId||(this.scrollAnimationCb=this.performScroll.bind(this),this.scrollAnimationFrameId=window.requestAnimationFrame(this.scrollAnimationCb))},a.prototype.teardownScrollAnimation=function(){this.scrollAnimationFrameId&&(window.cancelAnimationFrame(this.scrollAnimationFrameId),this.scrollAnimationFrameId=null,this.scrollAnimationCb=null)},a.prototype.performScroll=function(){if(this.scrollAnimationCb&&this.scrollAnimationFrameId){var b=a.HorizontalScrollEndReach(this.scrollIntention),c=a.VerticalScrollEndReach(this.scrollIntention);if(b&&c)return void this.teardownScrollAnimation();if(!b){var d=this.scrollIntention.x*this.config.scrollVelocity;a.GetSetHorizontalScroll(window.document,d),this.dragImagePageCoordinates.x+=d}if(!c){var e=this.scrollIntention.y*this.config.scrollVelocity;a.GetSetVerticalScroll(window.document,e),this.dragImagePageCoordinates.y+=e}this.translateDragImage(this.dragImagePageCoordinates.x,this.dragImagePageCoordinates.y),this.scrollAnimationFrameId=window.requestAnimationFrame(this.scrollAnimationCb)}},a.GetSetHorizontalScroll=function(a,b){return 1===arguments.length?a.documentElement.scrollLeft||a.body.scrollLeft:(a.documentElement.scrollLeft+=b,void(a.body.scrollLeft+=b))},a.GetSetVerticalScroll=function(a,b){return 1===arguments.length?a.documentElement.scrollTop||a.body.scrollTop:(a.documentElement.scrollTop+=b,void(a.body.scrollTop+=b))},a.HorizontalScrollEndReach=function(b){var c=a.GetSetHorizontalScroll(document);if(b.x>0){var d=document.documentElement.scrollWidth||document.body.scrollWidth;return c+document.documentElement.clientWidth>=d}return b.x<0?0>=c:!0},a.VerticalScrollEndReach=function(b){var c=a.GetSetVerticalScroll(document);if(b.y>0){var d=document.documentElement.scrollHeight||document.body.scrollHeight;return c+document.documentElement.clientHeight>=d}return b.y<0?0>=c:!0},a.PrepareNodeCopyAsDragImage=function(b,c){if(1===b.nodeType){c.removeAttribute("id"),c.removeAttribute("class"),c.removeAttribute("style"),c.removeAttribute("draggable");for(var d=window.getComputedStyle(b),e=0;e<d.length;e++){var f=d[e];c.style.setProperty(f,d.getPropertyValue(f),d.getPropertyPriority(f))}c.style["pointer-events"]="none"}if(b.hasChildNodes())for(var e=0;e<b.childNodes.length;e++)a.PrepareNodeCopyAsDragImage(b.childNodes[e],c.childNodes[e])},a.prototype.createDragImage=function(b){this.dragImage=this.sourceNode.cloneNode(!0),a.PrepareNodeCopyAsDragImage(this.sourceNode,this.dragImage),this.dragImage.style.position="absolute",this.dragImage.style.left="0px",this.dragImage.style.top="0px",this.dragImage.style["z-index"]="999999",this.dragImage.classList.add(a.class_drag_image),this.dragImage.classList.add(a.class_drag_operation_icon),this.config.dragImageClass&&this.dragImage.classList.add(this.config.dragImageClass),this.dragImagePageCoordinates={x:null,y:null},f.UpdateCentroidCoordinatesOfTouchesIn("page",b,this.dragImagePageCoordinates),this.translateDragImage(this.dragImagePageCoordinates.x,this.dragImagePageCoordinates.y),window.document.body.appendChild(this.dragImage)},a.prototype.translateDragImage=function(b,c,d){void 0===d&&(d=!0),d&&(b-=parseInt(this.dragImage.offsetWidth,10)/2,c-=parseInt(this.dragImage.offsetHeight,10)/2);for(var e="translate3d("+b+"px,"+c+"px, 0)",f=0;f<a.transform_css_vendor_prefixes.length;f++){var g=a.transform_css_vendor_prefixes[f]+"transform";this.dragImage.style[g]=e}},a.prototype.snapbackDragImage=function(){var b=this.sourceNode,c=window.getComputedStyle(b,null).getPropertyValue("visibility"),d=window.getComputedStyle(b,null).getPropertyValue("display");if("hidden"===c||"none"===d)return void this.snapbackTransitionEnded();this.dragImage.addEventListener("transitionend",this.snapbackEndedCb),this.dragImage.addEventListener("webkitTransitionEnd",this.snapbackEndedCb),this.dragImage.classList.add(a.class_drag_image_snapback);var e,f,g=b.getBoundingClientRect(),h=document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop,i=document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft;f=g.top+h,e=g.left+i;var j=window.getComputedStyle(this.sourceNode,null),k=parseInt(j.getPropertyValue("padding-left"),10),l=parseInt(j.getPropertyValue("padding-top"),10);e-=k,f-=l,this.translateDragImage(e,f,!1)},a.prototype.snapbackTransitionEnded=function(){this.dragImage.removeEventListener("transitionend",this.snapbackEndedCb),this.dragImage.removeEventListener("webkitTransitionEnd",this.snapbackEndedCb),this.dragDataStore.mode=3,this.dataTransfer.dropEffect=this.currentDragOperation,this.dispatchDragEvent("dragend",this.sourceNode,this.lastTouchEvent,this.dragDataStore,this.dataTransfer,!1),this.dragOperationState=2,this.cleanup()},a.prototype.dragAndDropProcessModelIteration=function(){this.dragDataStore.mode=3,this.dataTransfer.dropEffect="none";var b=this.dispatchDragEvent("drag",this.sourceNode,this.lastTouchEvent,this.dragDataStore,this.dataTransfer);if(b&&(this.currentDragOperation="none"),b||2===this.dragOperationState||3===this.dragOperationState){var c=this.DragOperationEnded(this.dragOperationState);return c?void this.snapbackDragImage():(this.dragDataStore.mode=3,this.dataTransfer.dropEffect=this.currentDragOperation,this.dispatchDragEvent("dragend",this.sourceNode,this.lastTouchEvent,this.dragDataStore,this.dataTransfer,!1),this.dragOperationState=2,void this.cleanup())}var e=window.document.elementFromPoint(this.currentHotspotCoordinates.x,this.currentHotspotCoordinates.y),g=this.currentDropTarget;e!==this.immediateUserSelection&&e!==this.currentDropTarget&&(this.immediateUserSelection=e,null!==this.currentDropTarget&&(this.dragDataStore.mode=3,this.dataTransfer.dropEffect="none",this.dispatchDragEvent("dragexit",this.currentDropTarget,this.lastTouchEvent,this.dragDataStore,this.dataTransfer,!1)),null===this.immediateUserSelection?this.currentDropTarget=this.immediateUserSelection:(this.dragDataStore.mode=3,this.dataTransfer.dropEffect=a.DetermineDropEffect(this.dragDataStore.effectAllowed,this.sourceNode),this.dispatchDragEvent("dragenter",this.immediateUserSelection,this.lastTouchEvent,this.dragDataStore,this.dataTransfer)?(this.currentDropTarget=this.immediateUserSelection,this.currentDragOperation=a.DetermineDragOperation(this.dataTransfer)):this.immediateUserSelection===window.document.body||(this.currentDropTarget=window.document.body))),g!==this.currentDropTarget&&f.IsDOMElement(g)&&(this.dragDataStore.mode=3,this.dataTransfer.dropEffect="none",this.dispatchDragEvent("dragleave",g,this.lastTouchEvent,this.dragDataStore,this.dataTransfer,!1,this.currentDropTarget)),f.IsDOMElement(this.currentDropTarget)&&(this.dragDataStore.mode=3,this.dataTransfer.dropEffect=a.DetermineDropEffect(this.dragDataStore.effectAllowed,this.sourceNode),this.dispatchDragEvent("dragover",this.currentDropTarget,this.lastTouchEvent,this.dragDataStore,this.dataTransfer)===!1?this.currentDragOperation="none":this.currentDragOperation=a.DetermineDragOperation(this.dataTransfer));for(var h=0;h<d.DropEffects.length;h++)this.dragImage.classList.remove(a.class_prefix+d.DropEffects[h]);this.dragImage.classList.add(a.class_prefix+this.currentDragOperation)},a.prototype.DragOperationEnded=function(a){var b="none"===this.currentDragOperation||null===this.currentDropTarget||3===a;return b?f.IsDOMElement(this.currentDropTarget)&&(this.dragDataStore.mode=3,this.dataTransfer.dropEffect="none",this.dispatchDragEvent("dragleave",this.currentDropTarget,this.lastTouchEvent,this.dragDataStore,this.dataTransfer,!1)):f.IsDOMElement(this.currentDropTarget)&&(this.dragDataStore.mode=1,this.dataTransfer.dropEffect=this.currentDragOperation,this.dispatchDragEvent("drop",this.currentDropTarget,this.lastTouchEvent,this.dragDataStore,this.dataTransfer)===!0?this.currentDragOperation=this.dataTransfer.dropEffect:this.currentDragOperation="none"),b},a.DetermineDragOperation=function(a){if("uninitialized"===a.effectAllowed||"all"===a.effectAllowed)return a.dropEffect;if("copy"===a.dropEffect){if(0===a.effectAllowed.indexOf("copy"))return"copy"}else if("link"===a.dropEffect){if(0===a.effectAllowed.indexOf("link")||a.effectAllowed.indexOf("Link")>-1)return"link"}else if("move"===a.dropEffect&&(0===a.effectAllowed.indexOf("move")||a.effectAllowed.indexOf("Move")>-1))return"move";return"none"},a.DetermineDropEffect=function(a,b){return"none"===a?"none":0===a.indexOf("copy")||"all"===a?"copy":0===a.indexOf("link")?"link":"move"===a?"move":"uninitialized"===a&&3===b.nodeType&&"A"===b.tagName?"link":"copy"},a.prototype.dispatchDragEvent=function(a,b,c,d,e,g,h){void 0===g&&(g=!0),void 0===h&&(h=null);var i=f.CreateDragEventFromTouch(b,c,a,g,window.document.defaultView,e,h),j=!b.dispatchEvent(i);return d.mode=0,j},a.class_prefix="dnd-poly-",a.class_drag_image=a.class_prefix+"drag-image",a.class_drag_image_snapback=a.class_prefix+"snapback",a.class_drag_operation_icon=a.class_prefix+"icon",a.transform_css_vendor_prefixes=["","-webkit-"],a}(),d=function(){function a(a){this.dataStore=a,this._dropEffect="none"}return Object.defineProperty(a.prototype,"files",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"items",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"types",{get:function(){return 0===this.dataStore.mode?null:Object.freeze(this.dataStore.types)},enumerable:!0,configurable:!0}),a.prototype.setData=function(a,b){if(2===this.dataStore.mode){if(a.indexOf(" ")>-1)throw new Error("Space character not allowed in drag data item type string");this.dataStore.data[a]=b,-1===this.dataStore.types.indexOf(a)&&this.dataStore.types.push(a)}},a.prototype.getData=function(a){return 0===this.dataStore.mode||3===this.dataStore.mode?null:this.dataStore.data[a]||""},a.prototype.clearData=function(a){if(2===this.dataStore.mode){if(a&&this.dataStore.data[a]){delete this.dataStore.data[a];var b=this.dataStore.types.indexOf(a);return void(b>-1&&this.dataStore.types.splice(b,1))}this.dataStore.data={},this.dataStore.types=[]}},a.prototype.setDragImage=function(a,b,c){0===this.dataStore.mode},Object.defineProperty(a.prototype,"effectAllowed",{get:function(){return this.dataStore.effectAllowed},set:function(b){0!==this.dataStore.mode&&-1!==a.AllowedEffects.indexOf(b)&&(this.dataStore.effectAllowed=b)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"dropEffect",{get:function(){return this._dropEffect},set:function(b){0!==this.dataStore.mode&&-1!==a.DropEffects.indexOf(b)&&(this._dropEffect=b)},enumerable:!0,configurable:!0}),a.AllowedEffects=["none","copy","copyLink","copyMove","link","linkMove","move","all"],a.DropEffects=["none","copy","move","link"],a}(),e=function(){function a(){this.mode=3,this.data={},this.types=[],this.effectAllowed="uninitialized"}return a}(),f=function(){function a(){}return a.Average=function(a){return 0===a.length?0:a.reduce(function(a,b){return b+a},0)/a.length},a.IsDOMElement=function(a){return a&&a.tagName},a.IsTouchIdentifierContainedInTouchEvent=function(a,b){for(var c=0;c<a.changedTouches.length;c++){var d=a.changedTouches[c];if(d.identifier===b)return!0}return!1},a.CreateMouseEventFromTouch=function(a,b,c,d,e,f){void 0===d&&(d=!0),void 0===e&&(e=document.defaultView),void 0===f&&(f=null);var g=document.createEvent("MouseEvents"),h=b.changedTouches[0];g.initMouseEvent(c,!0,d,e,1,h.screenX,h.screenY,h.clientX,h.clientY,b.ctrlKey,b.altKey,b.shiftKey,b.metaKey,0,f);var i=a.getBoundingClientRect();return g.offsetX=g.clientX-i.left,g.offsetY=g.clientY-i.top,g},a.CreateDragEventFromTouch=function(a,b,c,d,e,f,g){void 0===g&&(g=null);var h=b.changedTouches[0],i=document.createEvent("Event");i.initEvent(c,!0,d),i.dataTransfer=f,i.relatedTarget=g,i.screenX=h.screenX,i.screenY=h.screenY,i.clientX=h.clientX,i.clientY=h.clientY;var j=a.getBoundingClientRect();return i.offsetX=i.clientX-j.left,i.offsetY=i.clientY-j.top,i},a.UpdateCentroidCoordinatesOfTouchesIn=function(b,c,d){for(var e=[],f=[],g=0;g<c.touches.length;g++){var h=c.touches[g];e.push(h[b+"X"]),f.push(h[b+"Y"])}d.x=a.Average(e),d.y=a.Average(f)},a}()}(MobileDragAndDropPolyfill||(MobileDragAndDropPolyfill={}));
//# sourceMappingURL=mobile-drag-and-drop-polyfill.min.map