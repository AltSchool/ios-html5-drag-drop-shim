/*! drag-drop-webkit-mobile 2.0.0 | Copyright (c) 2015 Tim Ruffles | BSD 2 License */
var MobileDragAndDropPolyfill;!function(a){function b(){var a={draggable:"draggable"in document.documentElement,dragEvents:"ondragstart"in document.documentElement,touchEvents:"ontouchstart"in document.documentElement,isBlinkEngine:!!window.chrome||/chrome/i.test(navigator.userAgent),userAgentNotSupportingNativeDnD:!1,transitionEnd:"WebkitTransition"in document.documentElement.style?"webkitTransitionEnd":"transitionend"};return a.userAgentNotSupportingNativeDnD=/iPad|iPhone|iPod|Android/.test(navigator.userAgent)||a.touchEvents&&a.isBlinkEngine,a}function c(a){x=b(),x.userAgentNotSupportingNativeDnD===!1&&x.draggable&&x.dragEvents||(a&&Object.keys(a).forEach(function(a){y[a]=y[a]}),document.addEventListener("touchstart",d))}function d(a){if(!z){var b=e(a);if(b){a.preventDefault();try{z=new H(y,b,a,f)}catch(c){throw f(a,3),c}}}}function e(a){var b=a.target;do if(b.draggable!==!1&&b.getAttribute&&"true"===b.getAttribute("draggable"))return b;while((b=b.parentNode)&&b!==document.body)}function f(a,b){if(z=null,0===b){var c,d=a.target,e=d.tagName;switch(e){case"SELECT":c="mousedown";break;case"INPUT":case"TEXTAREA":d.focus();default:c="click"}var f=k(d,a,c);d.dispatchEvent(f)}}function g(a){return 0===a.length?0:a.reduce(function(a,b){return b+a},0)/a.length}function h(a){return a&&a.tagName}function i(a,b,c){a.addEventListener(b,function(a){return a.target.removeEventListener(a.type,arguments.callee),c(a)})}function j(a,b){for(var c=0;c<a.changedTouches.length;c++){var d=a.changedTouches[c];if(d.identifier===b)return!0}return!1}function k(a,b,c,d,e,f){void 0===d&&(d=!0),void 0===e&&(e=document.defaultView),void 0===f&&(f=null);var g=document.createEvent("MouseEvents"),h=b.changedTouches[0];g.initMouseEvent(c,!0,d,e,1,h.screenX,h.screenY,h.clientX,h.clientY,b.ctrlKey,b.altKey,b.shiftKey,b.metaKey,0,f);var i=a.getBoundingClientRect();return g.offsetX=g.clientX-i.left,g.offsetY=g.clientY-i.top,g}function l(a,b,c,d,e,f,g){void 0===g&&(g=null);var h=b.changedTouches[0],i=document.createEvent("Event");i.initEvent(c,!0,d),i.dataTransfer=f,i.relatedTarget=g,i.screenX=h.screenX,i.screenY=h.screenY,i.clientX=h.clientX,i.clientY=h.clientY;var j=a.getBoundingClientRect();return i.offsetX=i.clientX-j.left,i.offsetY=i.clientY-j.top,i}function m(a,b,c){for(var d=[],e=[],f=0;f<b.touches.length;f++){var h=b.touches[f];d.push(h[a+"X"]),e.push(h[a+"Y"])}c.x=g(d),c.y=g(e)}function n(a,b){if(1===a.nodeType){b.removeAttribute("id"),b.removeAttribute("class"),b.removeAttribute("style"),b.removeAttribute("draggable");for(var c=window.getComputedStyle(a),d=0;d<c.length;d++){var e=c[d];b.style.setProperty(e,c.getPropertyValue(e),c.getPropertyPriority(e))}b.style["pointer-events"]="none"}if(a.hasChildNodes())for(var d=0;d<a.childNodes.length;d++)n(a.childNodes[d],b.childNodes[d])}function o(a,b){var c=a.cloneNode(!0);return n(a,c),c.style.position="absolute",c.style.left="0px",c.style.top="0px",c.style["z-index"]="999999",c.classList.add(E),c.classList.add(G),b&&c.classList.add(b),c}function p(a,b,c,d){void 0===d&&(d=!0),d&&(b-=parseInt(a.offsetWidth,10)/2,c-=parseInt(a.offsetHeight,10)/2);for(var e="translate3d("+b+"px,"+c+"px, 0)",f=0;f<C.length;f++){var g=C[f]+"transform";a.style[g]=e}}function q(a,b,c,d){i(c,a,d),c.classList.add(F);var e,f,g=b.getBoundingClientRect(),h=document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop,j=document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft;f=g.top+h,e=g.left+j;var k=window.getComputedStyle(b,null),l=parseInt(k.getPropertyValue("padding-left"),10),m=parseInt(k.getPropertyValue("padding-top"),10);e-=l,f-=m,p(c,e,f,!1)}function r(a,b,c){return c>a?-1:c>b-a?1:0}function s(a,b){var c=0===a?"scrollLeft":"scrollTop";return 1===arguments.length?document.documentElement[c]||document.body[c]:(document.documentElement[c]+=b,void(document.body[c]+=b))}function t(a,b){var c,d,e;if(0===a?(c="scrollWidth",d="clientWidth"):(c="scrollHeight",d="clientHeight"),e=s(a),b>0){var f=document.documentElement[c]||document.body[c];return e+document.documentElement[d]>=f}return 0>b?0>=e:!0}function u(a,b){return"none"===a?"none":0===a.indexOf("copy")||"all"===a?"copy":0===a.indexOf("link")?"link":"move"===a?"move":"uninitialized"===a&&3===b.nodeType&&"A"===b.tagName?"link":"copy"}function v(a,b,c,d,e,f,g){void 0===f&&(f=!0),void 0===g&&(g=null);var h=l(b,c,a,f,document.defaultView,e,g),i=!b.dispatchEvent(h);return d.mode=0,i}function w(a,b){if("uninitialized"===a||"all"===a)return b;if("copy"===b){if(0===a.indexOf("copy"))return"copy"}else if("link"===b){if(0===a.indexOf("link")||a.indexOf("Link")>-1)return"link"}else if("move"===b&&(0===a.indexOf("move")||a.indexOf("Move")>-1))return"move";return"none"}var x,y={dragImageClass:null,iterationInterval:150,scrollThreshold:50,scrollVelocity:10,debug:!1};a.Initialize=c;var z,A=["none","copy","copyLink","copyMove","link","linkMove","move","all"],B=["none","copy","move","link"],C=["","-webkit-"],D="dnd-poly-",E=D+"drag-image",F=D+"snapback",G=D+"icon",H=function(){function a(a,b,c,d){this.config=a,this.sourceNode=b,this.dragOperationEndedCb=d,this.dragOperationState=0,this.immediateUserSelection=null,this.currentDropTarget=null,this.lastTouchEvent=c,this.initialTouchId=c.changedTouches[0].identifier,this.touchMoveHandler=this.onTouchMove.bind(this),this.touchEndOrCancelHandler=this.onTouchEndOrCancel.bind(this),document.addEventListener("touchmove",this.touchMoveHandler),document.addEventListener("touchend",this.touchEndOrCancelHandler),document.addEventListener("touchcancel",this.touchEndOrCancelHandler)}return a.prototype.setup=function(){var a=this;return this.dragOperationState=1,this.currentDragOperation="none",this.dragDataStore=new J,this.dataTransfer=new I(this.dragDataStore),this.currentHotspotCoordinates={x:null,y:null},this.dragImagePageCoordinates={x:null,y:null},m("page",this.lastTouchEvent,this.dragImagePageCoordinates),this.dragImage=o(this.sourceNode,this.config.dragImageClass),p(this.dragImage,this.dragImagePageCoordinates.x,this.dragImagePageCoordinates.y),document.body.appendChild(this.dragImage),this.dragDataStore.mode=2,this.dataTransfer.dropEffect="none",v("dragstart",this.sourceNode,this.lastTouchEvent,this.dragDataStore,this.dataTransfer)?(this.dragOperationState=3,void this.cleanup()):(this.scrollIntention={x:null,y:null},this.scrollAnimationFrameHandler=this.scrollAnimation.bind(this),void(this.iterationIntervalId=setInterval(function(){a.iterationLock||(a.iterationLock=!0,a.dragAndDropProcessModelIteration(),a.iterationLock=!1)},this.config.iterationInterval)))},a.prototype.cleanup=function(){this.iterationIntervalId&&(clearInterval(this.iterationIntervalId),this.iterationIntervalId=null),document.removeEventListener("touchmove",this.touchMoveHandler),document.removeEventListener("touchend",this.touchEndOrCancelHandler),document.removeEventListener("touchcancel",this.touchEndOrCancelHandler),this.dragImage&&(this.dragImage.parentNode.removeChild(this.dragImage),this.dragImage=null),this.dragOperationEndedCb(this.lastTouchEvent,this.dragOperationState)},a.prototype.onTouchMove=function(a){if(j(a,this.initialTouchId)!==!1){if(0===this.dragOperationState)return void this.setup();a.preventDefault(),a.stopImmediatePropagation(),this.lastTouchEvent=a,m("client",a,this.currentHotspotCoordinates),m("page",a,this.dragImagePageCoordinates),this.scrollIntention.x=r(this.currentHotspotCoordinates.x,document.documentElement.clientWidth,this.config.scrollThreshold),this.scrollIntention.y=r(this.currentHotspotCoordinates.y,document.documentElement.clientHeight,this.config.scrollThreshold);var b=t(0,this.scrollIntention.x),c=t(1,this.scrollIntention.y);b&&c?p(this.dragImage,this.dragImagePageCoordinates.x,this.dragImagePageCoordinates.y):this.scrollAnimationId||(this.scrollAnimationId=window.requestAnimationFrame(this.scrollAnimationFrameHandler))}},a.prototype.onTouchEndOrCancel=function(a){if(j(a,this.initialTouchId)!==!1){if(this.scrollIntention.x=this.scrollIntention.y=0,0===this.dragOperationState)return void this.cleanup();a.preventDefault(),a.stopImmediatePropagation(),this.lastTouchEvent=a,this.dragOperationState="touchcancel"===a.type?3:2}},a.prototype.scrollAnimation=function(){var a=t(0,this.scrollIntention.x),b=t(1,this.scrollIntention.y);if(a&&b)return void(this.scrollAnimationId=null);if(!a){var c=this.scrollIntention.x*this.config.scrollVelocity;s(0,c),this.dragImagePageCoordinates.x+=c}if(!b){var d=this.scrollIntention.y*this.config.scrollVelocity;s(1,d),this.dragImagePageCoordinates.y+=d}p(this.dragImage,this.dragImagePageCoordinates.x,this.dragImagePageCoordinates.y),this.scrollAnimationId=window.requestAnimationFrame(this.scrollAnimationFrameHandler)},a.prototype.dragAndDropProcessModelIteration=function(){var a=this;this.dragDataStore.mode=3,this.dataTransfer.dropEffect="none";var b=v("drag",this.sourceNode,this.lastTouchEvent,this.dragDataStore,this.dataTransfer);if(b&&(this.currentDragOperation="none"),b||2===this.dragOperationState||3===this.dragOperationState){var c=this.dragOperationEnded(this.dragOperationState);if(c){var d=window.getComputedStyle(this.sourceNode,null),e=d.getPropertyValue("visibility"),f=d.getPropertyValue("display");return void("hidden"===e||"none"===f?this.finishDragOperation():q(x.transitionEnd,this.sourceNode,this.dragImage,function(){a.finishDragOperation()}))}return void this.finishDragOperation()}var g=document.elementFromPoint(this.currentHotspotCoordinates.x,this.currentHotspotCoordinates.y),i=this.currentDropTarget;g!==this.immediateUserSelection&&g!==this.currentDropTarget&&(this.immediateUserSelection=g,null!==this.currentDropTarget&&(this.dragDataStore.mode=3,this.dataTransfer.dropEffect="none",v("dragexit",this.currentDropTarget,this.lastTouchEvent,this.dragDataStore,this.dataTransfer,!1)),null===this.immediateUserSelection?this.currentDropTarget=this.immediateUserSelection:(this.dragDataStore.mode=3,this.dataTransfer.dropEffect=u(this.dragDataStore.effectAllowed,this.sourceNode),v("dragenter",this.immediateUserSelection,this.lastTouchEvent,this.dragDataStore,this.dataTransfer)?(this.currentDropTarget=this.immediateUserSelection,this.currentDragOperation=w(this.dataTransfer.effectAllowed,this.dataTransfer.dropEffect)):this.immediateUserSelection===document.body||(this.currentDropTarget=document.body))),i!==this.currentDropTarget&&h(i)&&(this.dragDataStore.mode=3,this.dataTransfer.dropEffect="none",v("dragleave",i,this.lastTouchEvent,this.dragDataStore,this.dataTransfer,!1,this.currentDropTarget)),h(this.currentDropTarget)&&(this.dragDataStore.mode=3,this.dataTransfer.dropEffect=u(this.dragDataStore.effectAllowed,this.sourceNode),v("dragover",this.currentDropTarget,this.lastTouchEvent,this.dragDataStore,this.dataTransfer)===!1?this.currentDragOperation="none":this.currentDragOperation=w(this.dataTransfer.effectAllowed,this.dataTransfer.dropEffect));for(var j=0;j<B.length;j++)this.dragImage.classList.remove(D+B[j]);this.dragImage.classList.add(D+this.currentDragOperation)},a.prototype.dragOperationEnded=function(a){var b="none"===this.currentDragOperation||null===this.currentDropTarget||3===a;return b?h(this.currentDropTarget)&&(this.dragDataStore.mode=3,this.dataTransfer.dropEffect="none",v("dragleave",this.currentDropTarget,this.lastTouchEvent,this.dragDataStore,this.dataTransfer,!1)):h(this.currentDropTarget)&&(this.dragDataStore.mode=1,this.dataTransfer.dropEffect=this.currentDragOperation,v("drop",this.currentDropTarget,this.lastTouchEvent,this.dragDataStore,this.dataTransfer)===!0?this.currentDragOperation=this.dataTransfer.dropEffect:this.currentDragOperation="none"),b},a.prototype.finishDragOperation=function(){this.dragDataStore.mode=3,this.dataTransfer.dropEffect=this.currentDragOperation,v("dragend",this.sourceNode,this.lastTouchEvent,this.dragDataStore,this.dataTransfer,!1),this.dragOperationState=2,this.cleanup()},a}(),I=function(){function a(a){this.dataStore=a,this._dropEffect="none"}return Object.defineProperty(a.prototype,"files",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"items",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"types",{get:function(){return 0===this.dataStore.mode?null:Object.freeze(this.dataStore.types)},enumerable:!0,configurable:!0}),a.prototype.setData=function(a,b){if(2===this.dataStore.mode){if(a.indexOf(" ")>-1)throw new Error("Space character not allowed in drag data item type string");this.dataStore.data[a]=b,-1===this.dataStore.types.indexOf(a)&&this.dataStore.types.push(a)}},a.prototype.getData=function(a){return 0===this.dataStore.mode||3===this.dataStore.mode?null:this.dataStore.data[a]||""},a.prototype.clearData=function(a){if(2===this.dataStore.mode){if(a&&this.dataStore.data[a]){delete this.dataStore.data[a];var b=this.dataStore.types.indexOf(a);return void(b>-1&&this.dataStore.types.splice(b,1))}this.dataStore.data={},this.dataStore.types=[]}},a.prototype.setDragImage=function(a,b,c){0===this.dataStore.mode},Object.defineProperty(a.prototype,"effectAllowed",{get:function(){return this.dataStore.effectAllowed},set:function(a){0!==this.dataStore.mode&&-1!==A.indexOf(a)&&(this.dataStore.effectAllowed=a)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"dropEffect",{get:function(){return this._dropEffect},set:function(a){0!==this.dataStore.mode&&-1!==A.indexOf(a)&&(this._dropEffect=a)},enumerable:!0,configurable:!0}),a}(),J=function(){function a(){this.mode=3,this.data={},this.types=[],this.effectAllowed="uninitialized"}return a}()}(MobileDragAndDropPolyfill||(MobileDragAndDropPolyfill={}));
//# sourceMappingURL=mobile-drag-and-drop-polyfill.min.map